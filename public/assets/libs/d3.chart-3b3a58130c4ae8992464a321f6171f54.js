(function(){function e(e){return[0,e.length-1]}function t(e){return[d3.quantile(e,.25),d3.quantile(e,.5),d3.quantile(e,.75)]}function n(e){return e.ranges}function r(e){return e.markers}function i(e){return e.measures}function s(e){return function(t){return"translate("+e(t)+",0)"}}function o(e){var t=e(0);return function(n){return Math.abs(e(n)-t)}}function f(e){return e[0]}function l(e){return e[1]}function c(e,t){var n=t.length-1;return t=t.slice().sort(d3.ascending),d3.range(e).map(function(r){return t[~~(r*n/e)]})}function h(e){return e.x}function p(e){return e.y}d3.chart={},d3.chart.box=function(){function l(e){e.each(function(e,t){e=e.map(o).sort(d3.ascending);var l=d3.select(this),c=e.length,h=e[0],p=e[c-1],d=e.quartiles=a(e),v=u&&u.call(this,e,t),m=v&&v.map(function(t){return e[t]}),g=v?d3.range(0,v[0]).concat(d3.range(v[1]+1,c)):d3.range(c),y=d3.scale.linear().domain(s&&s.call(this,e,t)||[h,p]).range([r,0]),b=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(y.range());this.__chart__=y;var w=l.selectAll("line.center").data(m?[m]:[]);w.enter().insert("svg:line","rect").attr("class","center").attr("x1",n/2).attr("y1",function(e){return b(e[0])}).attr("x2",n/2).attr("y2",function(e){return b(e[1])}).style("opacity",1e-6).transition().duration(i).style("opacity",1).attr("y1",function(e){return y(e[0])}).attr("y2",function(e){return y(e[1])}),w.transition().duration(i).style("opacity",1).attr("y1",function(e){return y(e[0])}).attr("y2",function(e){return y(e[1])}),w.exit().transition().duration(i).style("opacity",1e-6).attr("y1",function(e){return y(e[0])}).attr("y2",function(e){return y(e[1])}).remove();var E=l.selectAll("rect.box").data([d]);E.enter().append("svg:rect").attr("class","box").attr("x",0).attr("y",function(e){return b(e[2])}).attr("width",n).attr("height",function(e){return b(e[0])-b(e[2])}).transition().duration(i).attr("y",function(e){return y(e[2])}).attr("height",function(e){return y(e[0])-y(e[2])}),E.transition().duration(i).attr("y",function(e){return y(e[2])}).attr("height",function(e){return y(e[0])-y(e[2])});var S=l.selectAll("line.median").data([d[1]]);S.enter().append("svg:line").attr("class","median").attr("x1",0).attr("y1",b).attr("x2",n).attr("y2",b).transition().duration(i).attr("y1",y).attr("y2",y),S.transition().duration(i).attr("y1",y).attr("y2",y);var x=l.selectAll("line.whisker").data(m||[]);x.enter().insert("svg:line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",b).attr("x2",n).attr("y2",b).style("opacity",1e-6).transition().duration(i).attr("y1",y).attr("y2",y).style("opacity",1),x.transition().duration(i).attr("y1",y).attr("y2",y).style("opacity",1),x.exit().transition().duration(i).attr("y1",y).attr("y2",y).style("opacity",1e-6).remove();var T=l.selectAll("circle.outlier").data(g,Number);T.enter().insert("svg:circle","text").attr("class","outlier").attr("r",5).attr("cx",n/2).attr("cy",function(t){return b(e[t])}).style("opacity",1e-6).transition().duration(i).attr("cy",function(t){return y(e[t])}).style("opacity",1),T.transition().duration(i).attr("cy",function(t){return y(e[t])}).style("opacity",1),T.exit().transition().duration(i).attr("cy",function(t){return y(e[t])}).style("opacity",1e-6).remove();var N=f||y.tickFormat(8),C=l.selectAll("text.box").data(d);C.enter().append("svg:text").attr("class","box").attr("dy",".3em").attr("dx",function(e,t){return t&1?6:-6}).attr("x",function(e,t){return t&1?n:0}).attr("y",b).attr("text-anchor",function(e,t){return t&1?"start":"end"}).text(N).transition().duration(i).attr("y",y),C.transition().duration(i).text(N).attr("y",y);var k=l.selectAll("text.whisker").data(m||[]);k.enter().append("svg:text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",n).attr("y",b).text(N).style("opacity",1e-6).transition().duration(i).attr("y",y).style("opacity",1),k.transition().duration(i).text(N).attr("y",y).style("opacity",1),k.exit().transition().duration(i).attr("y",y).style("opacity",1e-6).remove()}),d3.timer.flush()}var n=1,r=1,i=0,s=null,o=Number,u=e,a=t,f=null;return l.width=function(e){return arguments.length?(n=e,l):n},l.height=function(e){return arguments.length?(r=e,l):r},l.tickFormat=function(e){return arguments.length?(f=e,l):f},l.duration=function(e){return arguments.length?(i=e,l):i},l.domain=function(e){return arguments.length?(s=e==null?e:d3.functor(e),l):s},l.value=function(e){return arguments.length?(o=e,l):o},l.whiskers=function(e){return arguments.length?(u=e,l):u},l.quartiles=function(e){return arguments.length?(a=e,l):a},l},d3.chart.bullet=function(){function d(e){e.each(function(e,n){var r=a.call(this,e,n).slice().sort(d3.descending),i=f.call(this,e,n).slice().sort(d3.descending),d=l.call(this,e,n).slice().sort(d3.descending),v=d3.select(this),m=d3.scale.linear().domain([0,Math.max(r[0],i[0],d[0])]).range(t?[c,0]:[0,c]),g=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(m.range());this.__chart__=m;var y=o(g),b=o(m),w=v.selectAll("rect.range").data(r);w.enter().append("svg:rect").attr("class",function(e,t){return"range s"+t}).attr("width",y).attr("height",h).attr("x",t?g:0).transition().duration(u).attr("width",b).attr("x",t?m:0),w.transition().duration(u).attr("x",t?m:0).attr("width",b).attr("height",h);var E=v.selectAll("rect.measure").data(d);E.enter().append("svg:rect").attr("class",function(e,t){return"measure s"+t}).attr("width",y).attr("height",h/3).attr("x",t?g:0).attr("y",h/3).transition().duration(u).attr("width",b).attr("x",t?m:0),E.transition().duration(u).attr("width",b).attr("height",h/3).attr("x",t?m:0).attr("y",h/3);var S=v.selectAll("line.marker").data(i);S.enter().append("svg:line").attr("class","marker").attr("x1",g).attr("x2",g).attr("y1",h/6).attr("y2",h*5/6).transition().duration(u).attr("x1",m).attr("x2",m),S.transition().duration(u).attr("x1",m).attr("x2",m).attr("y1",h/6).attr("y2",h*5/6);var x=p||m.tickFormat(8),T=v.selectAll("g.tick").data(m.ticks(8),function(e){return this.textContent||x(e)}),N=T.enter().append("svg:g").attr("class","tick").attr("transform",s(g)).style("opacity",1e-6);N.append("svg:line").attr("y1",h).attr("y2",h*7/6),N.append("svg:text").attr("text-anchor","middle").attr("dy","1em").attr("y",h*7/6).text(x),N.transition().duration(u).attr("transform",s(m)).style("opacity",1);var C=T.transition().duration(u).attr("transform",s(m)).style("opacity",1);C.select("line").attr("y1",h).attr("y2",h*7/6),C.select("text").attr("y",h*7/6),T.exit().transition().duration(u).attr("transform",s(m)).style("opacity",1e-6).remove()}),d3.timer.flush()}var e="left",t=!1,u=0,a=n,f=r,l=i,c=380,h=30,p=null;return d.orient=function(n){return arguments.length?(e=n,t=e=="right"||e=="bottom",d):e},d.ranges=function(e){return arguments.length?(a=e,d):a},d.markers=function(e){return arguments.length?(f=e,d):f},d.measures=function(e){return arguments.length?(l=e,d):l},d.width=function(e){return arguments.length?(c=e,d):c},d.height=function(e){return arguments.length?(h=e,d):h},d.tickFormat=function(e){return arguments.length?(p=e,d):p},d.duration=function(e){return arguments.length?(u=e,d):u},d},d3.chart.horizon=function(){function p(f){f.each(function(f,l){var p=d3.select(this),d=2*e+1,v=Infinity,m=-Infinity,g=-Infinity,b,E,S,T=f.map(function(e,t){var n=r.call(this,e,t),s=i.call(this,e,t);return n<v&&(v=n),n>m&&(m=n),-s>g&&(g=-s),s>g&&(g=s),[n,s]}),N=d3.scale.linear().domain([v,m]).range([0,s]),C=d3.scale.linear().domain([0,g]).range([0,o*e]);this.__chart__?(b=this.__chart__.x,E=this.__chart__.y,S=this.__chart__.id):(b=d3.scale.linear().domain([0,Infinity]).range(N.range()),E=d3.scale.linear().domain([0,Infinity]).range(C.range()),S=++a);var k=p.selectAll("defs").data([T]),L=k.enter().append("svg:defs");L.append("svg:clipPath").attr("id","d3_chart_horizon_clip"+S).append("svg:rect").attr("width",s).attr("height",o),k.select("rect").transition().duration(c).attr("width",s).attr("height",o),L.append("svg:path").attr("id","d3_chart_horizon_path"+S).attr("d",u.interpolate(n).x(function(e){return b(e[0])}).y0(o*e).y1(function(t){return o*e-E(t[1])})).transition().duration(c).attr("d",u.x(function(e){return N(e[0])}).y1(function(t){return o*e-C(t[1])})),k.select("path").transition().duration(c).attr("d",u),p.selectAll("g").data([null]).enter().append("svg:g").attr("clip-path","url(#d3_chart_horizon_clip"+S+")");var A=t=="offset"?function(t){return"translate(0,"+(t+(t<0)-e)*o+")"}:function(t){return(t<0?"scale(1,-1)":"")+"translate(0,"+(t-e)*o+")"},O=p.select("g").selectAll("use").data(d3.range(-1,-e-1,-1).concat(d3.range(1,e+1)),Number);O.enter().append("svg:use").attr("xlink:href","#d3_chart_horizon_path"+S).attr("transform",function(e){return A(e+(e>0?1:-1))}).style("fill",h).transition().duration(c).attr("transform",A),O.transition().duration(c).attr("transform",A).style("fill",h),O.exit().transition().duration(c).attr("transform",A).remove(),this.__chart__={x:N,y:C,id:S}}),d3.timer.flush()}var e=1,t="offset",n="linear",r=f,i=l,s=960,o=40,c=0,h=d3.scale.linear().domain([-1,0,1]).range(["#d62728","#fff","#1f77b4"]);return p.duration=function(e){return arguments.length?(c=+e,p):c},p.bands=function(t){return arguments.length?(e=+t,h.domain([-e,0,e]),p):e},p.mode=function(e){return arguments.length?(t=e+"",p):t},p.colors=function(e){return arguments.length?(h.range(e),p):h.range()},p.interpolate=function(e){return arguments.length?(n=e+"",p):n},p.x=function(e){return arguments.length?(r=e,p):r},p.y=function(e){return arguments.length?(i=e,p):i},p.width=function(e){return arguments.length?(s=+e,p):s},p.height=function(e){return arguments.length?(o=+e,p):o},p};var u=d3.svg.area(),a=0;d3.chart.qq=function(){function a(a){a.each(function(a,f){var l=d3.select(this),h=c(s,o.call(this,a,f)),p=c(s,u.call(this,a,f)),d=r&&r.call(this,a,f)||[d3.min(h),d3.max(h)],v=r&&r.call(this,a,f)||[d3.min(p),d3.max(p)],m,g,b=d3.scale.linear().domain(d).range([0,e]),w=d3.scale.linear().domain(v).range([t,0]);this.__chart__?(m=this.__chart__.x,g=this.__chart__.y):(m=d3.scale.linear().domain([0,Infinity]).range(b.range()),g=d3.scale.linear().domain([0,Infinity]).range(w.range())),this.__chart__={x:b,y:w};var E=l.selectAll("line.diagonal").data([null]);E.enter().append("svg:line").attr("class","diagonal").attr("x1",b(v[0])).attr("y1",w(d[0])).attr("x2",b(v[1])).attr("y2",w(d[1])),E.transition().duration(n).attr("x1",b(v[0])).attr("y1",w(d[0])).attr("x2",b(v[1])).attr("y2",w(d[1]));var S=l.selectAll("circle").data(d3.range(s).map(function(e){return{x:h[e],y:p[e]}}));S.enter().append("svg:circle").attr("class","quantile").attr("r",4.5).attr("cx",function(e){return m(e.x)}).attr("cy",function(e){return g(e.y)}).style("opacity",1e-6).transition().duration(n).attr("cx",function(e){return b(e.x)}).attr("cy",function(e){return w(e.y)}).style("opacity",1),S.transition().duration(n).attr("cx",function(e){return b(e.x)}).attr("cy",function(e){return w(e.y)}).style("opacity",1),S.exit().transition().duration(n).attr("cx",function(e){return b(e.x)}).attr("cy",function(e){return w(e.y)}).style("opacity",1e-6).remove();var T=i||b.tickFormat(4),N=i||w.tickFormat(4),C=function(e){return"translate("+b(e)+","+t+")"},k=function(e){return"translate(0,"+w(e)+")"},L=l.selectAll("g.x.tick").data(b.ticks(4),function(e){return this.textContent||T(e)}),A=L.enter().append("svg:g").attr("class","x tick").attr("transform",function(e){return"translate("+m(e)+","+t+")"}).style("opacity",1e-6);A.append("svg:line").attr("y1",0).attr("y2",-6),A.append("svg:text").attr("text-anchor","middle").attr("dy","1em").text(T),A.transition().duration(n).attr("transform",C).style("opacity",1),L.transition().duration(n).attr("transform",C).style("opacity",1),L.exit().transition().duration(n).attr("transform",C).style("opacity",1e-6).remove();var O=l.selectAll("g.y.tick").data(w.ticks(4),function(e){return this.textContent||N(e)}),M=O.enter().append("svg:g").attr("class","y tick").attr("transform",function(e){return"translate(0,"+g(e)+")"}).style("opacity",1e-6);M.append("svg:line").attr("x1",0).attr("x2",6),M.append("svg:text").attr("text-anchor","end").attr("dx","-.5em").attr("dy",".3em").text(N),M.transition().duration(n).attr("transform",k).style("opacity",1),O.transition().duration(n).attr("transform",k).style("opacity",1),O.exit().transition().duration(n).attr("transform",k).style("opacity",1e-6).remove()})}var e=1,t=1,n=0,r=null,i=null,s=100,o=h,u=p;return a.width=function(t){return arguments.length?(e=t,a):e},a.height=function(e){return arguments.length?(t=e,a):t},a.duration=function(e){return arguments.length?(n=e,a):n},a.domain=function(e){return arguments.length?(r=e==null?e:d3.functor(e),a):r},a.count=function(e){return arguments.length?(s=e,a):s},a.x=function(e){return arguments.length?(o=e,a):o},a.y=function(e){return arguments.length?(u=e,a):u},a.tickFormat=function(e){return arguments.length?(i=e,a):i},a}})();