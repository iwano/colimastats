(function(){function e(e){var t=0,n=0;for(;;){if(e(t,n))return[t,n];t===0?(t=n+1,n=0):(t-=1,n+=1)}}function t(e,t,n,r){var i,s,o,u,a,f,l;return i=r[e],s=i[0],o=i[1],i=r[t],u=i[0],a=i[1],i=r[n],f=i[0],l=i[1],(l-o)*(u-s)-(a-o)*(f-s)>0}function n(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function r(e,t,n,r){var i=e[0],s=t[0],o=n[0],u=r[0],a=e[1],f=t[1],l=n[1],c=r[1],h=i-o,p=s-i,d=u-o,v=a-l,m=f-a,g=c-l,y=(d*v-g*h)/(g*p-d*m);return[i+y*p,a+y*m]}function i(e,t){var n={list:e.map(function(e,t){return{index:t,x:e[0],y:e[1]}}).sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}),bottomSite:null},r={list:[],leftEnd:null,rightEnd:null,init:function(){r.leftEnd=r.createHalfEdge(null,"l"),r.rightEnd=r.createHalfEdge(null,"l"),r.leftEnd.r=r.rightEnd,r.rightEnd.l=r.leftEnd,r.list.unshift(r.leftEnd,r.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound:function(e){var t=r.leftEnd;do t=t.r;while(t!=r.rightEnd&&i.rightOf(t,e));return t=t.l,t},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[l[e.side]]}},i={bisect:function(e,t){var n={region:{l:e,r:t},ep:{l:null,r:null}},r=t.x-e.x,i=t.y-e.y,s=r>0?r:-r,o=i>0?i:-i;return n.c=e.x*r+e.y*i+(r*r+i*i)*.5,s>o?(n.a=1,n.b=i/r,n.c/=r):(n.b=1,n.a=r/i,n.c/=i),n},intersect:function(e,t){var n=e.edge,r=t.edge;if(!n||!r||n.region.r==r.region.r)return null;var i=n.a*r.b-n.b*r.a;if(Math.abs(i)<1e-10)return null;var s=(n.c*r.b-r.c*n.b)/i,o=(r.c*n.a-n.c*r.a)/i,u=n.region.r,a=r.region.r,f,l;u.y<a.y||u.y==a.y&&u.x<a.x?(f=e,l=n):(f=t,l=r);var c=s>=l.region.r.x;return c&&f.side==="l"||!c&&f.side==="r"?null:{x:s,y:o}},rightOf:function(e,t){var n=e.edge,r=n.region.r,i=t.x>r.x;if(i&&e.side==="l")return 1;if(!i&&e.side==="r")return 0;if(n.a===1){var s=t.y-r.y,o=t.x-r.x,u=0,a=0;!i&&n.b<0||i&&n.b>=0?a=u=s>=n.b*o:(a=t.x+t.y*n.b>n.c,n.b<0&&(a=!a),a||(u=1));if(!u){var f=r.x-n.region.l.x;a=n.b*(o*o-s*s)<f*s*(1+2*o/f+n.b*n.b),n.b<0&&(a=!a)}}else{var l=n.c-n.a*t.x,c=t.y-l,h=t.x-r.x,p=l-r.y;a=c*c>h*h+p*p}return e.side==="l"?a:!a},endPoint:function(e,n,r){e.ep[n]=r;if(!e.ep[l[n]])return;t(e)},distance:function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}},s={list:[],insert:function(e,t,n){e.vertex=t,e.ystar=t.y+n;for(var r=0,i=s.list,o=i.length;r<o;r++){var u=i[r];if(e.ystar>u.ystar||e.ystar==u.ystar&&t.x>u.vertex.x)continue;break}i.splice(r,0,e)},del:function(e){for(var t=0,n=s.list,r=n.length;t<r&&n[t]!=e;++t);n.splice(t,1)},empty:function(){return s.list.length===0},nextEvent:function(e){for(var t=0,n=s.list,r=n.length;t<r;++t)if(n[t]==e)return n[t+1];return null},min:function(){var e=s.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return s.list.shift()}};r.init(),n.bottomSite=n.list.shift();var o=n.list.shift(),u,a,f,c,h,p,d,v,m,y,b,w,E;for(;;){s.empty()||(u=s.min());if(o&&(s.empty()||o.y<u.y||o.y==u.y&&o.x<u.x))a=r.leftBound(o),f=r.right(a),d=r.rightRegion(a),w=i.bisect(d,o),p=r.createHalfEdge(w,"l"),r.insert(a,p),y=i.intersect(a,p),y&&(s.del(a),s.insert(a,y,i.distance(y,o))),a=p,p=r.createHalfEdge(w,"r"),r.insert(a,p),y=i.intersect(p,f),y&&s.insert(p,y,i.distance(y,o)),o=n.list.shift();else{if(!!s.empty())break;a=s.extractMin(),c=r.left(a),f=r.right(a),h=r.right(f),d=r.leftRegion(a),v=r.rightRegion(f),b=a.vertex,i.endPoint(a.edge,a.side,b),i.endPoint(f.edge,f.side,b),r.del(a),s.del(f),r.del(f),E="l",d.y>v.y&&(m=d,d=v,v=m,E="r"),w=i.bisect(d,v),p=r.createHalfEdge(w,E),r.insert(c,p),i.endPoint(w,l[E],b),y=i.intersect(c,p),y&&(s.del(c),s.insert(c,y,i.distance(y,d))),y=i.intersect(p,h),y&&s.insert(p,y,i.distance(y,d))}}for(a=r.right(r.leftEnd);a!=r.rightEnd;a=r.right(a))t(a.edge)}function s(){return{leaf:!0,nodes:[],point:null}}function o(e,t,n,r,i,s){if(!e(t,n,r,i,s)){var u=(n+i)*.5,a=(r+s)*.5,f=t.nodes;f[0]&&o(e,f[0],n,r,u,a),f[1]&&o(e,f[1],u,r,i,a),f[2]&&o(e,f[2],n,a,u,s),f[3]&&o(e,f[3],u,a,i,s)}}function u(e){return{x:e[0],y:e[1]}}d3.geom={},d3.geom.contour=function(t,n){var r=n||e(t),i=[],s=r[0],o=r[1],u=0,l=0,h=NaN,p=NaN,d=0;do d=0,t(s-1,o-1)&&(d+=1),t(s,o-1)&&(d+=2),t(s-1,o)&&(d+=4),t(s,o)&&(d+=8),d===6?(u=p===-1?-1:1,l=0):d===9?(u=0,l=h===1?-1:1):(u=a[d],l=f[d]),u!=h&&l!=p&&(i.push([s,o]),h=u,p=l),s+=u,o+=l;while(r[0]!=s||r[1]!=o);return i};var a=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],f=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(e){if(e.length<3)return[];var n=e.length,r=n-1,i=[],s=[],o,u,a=0,f,l,c,h,p,v,m,g;for(o=1;o<n;++o)e[o][1]<e[a][1]?a=o:e[o][1]==e[a][1]&&(a=e[o][0]<e[a][0]?o:a);for(o=0;o<n;++o){if(o===a)continue;l=e[o][1]-e[a][1],f=e[o][0]-e[a][0],i.push({angle:Math.atan2(l,f),index:o})}i.sort(function(e,t){return e.angle-t.angle}),m=i[0].angle,v=i[0].index,p=0;for(o=1;o<r;++o)u=i[o].index,m==i[o].angle?(f=e[v][0]-e[a][0],l=e[v][1]-e[a][1],c=e[u][0]-e[a][0],h=e[u][1]-e[a][1],f*f+l*l>=c*c+h*h?i[o].index=-1:(i[p].index=-1,m=i[o].angle,p=o,v=u)):(m=i[o].angle,p=o,v=u);s.push(a);for(o=0,u=0;o<2;++u)i[u].index!==-1&&(s.push(i[u].index),o++);g=s.length;for(;u<r;++u){if(i[u].index===-1)continue;while(!t(s[g-2],s[g-1],i[u].index,e))--g;s[g++]=i[u].index}var y=[];for(o=0;o<g;++o)y.push(e[s[o]]);return y},d3.geom.polygon=function(e){return e.area=function(){var t=0,n=e.length,r=e[n-1][0]*e[0][1],i=e[n-1][1]*e[0][0];while(++t<n)r+=e[t-1][0]*e[t][1],i+=e[t-1][1]*e[t][0];return(i-r)*.5},e.centroid=function(t){var n=-1,r=e.length-1,i=0,s=0,o,u,a;arguments.length||(t=-1/(6*e.area()));while(++n<r)o=e[n],u=e[n+1],a=o[0]*u[1]-u[0]*o[1],i+=(o[0]+u[0])*a,s+=(o[1]+u[1])*a;return[i*t,s*t]},e.clip=function(t){var i,s=-1,o=e.length,u,a,f=e[o-1],l,c,h;while(++s<o){i=t.slice(),t.length=0,l=e[s],c=i[(a=i.length)-1],u=-1;while(++u<a)h=i[u],n(h,f,l)?(n(c,f,l)||t.push(r(c,h,f,l)),t.push(h)):n(c,f,l)&&t.push(r(c,h,f,l)),c=h;f=l}return t},e},d3.geom.voronoi=function(e){var t=e.map(function(){return[]});return i(e,function(e){var n,r,i,s,o,u;e.a===1&&e.b>=0?(n=e.ep.r,r=e.ep.l):(n=e.ep.l,r=e.ep.r),e.a===1?(o=n?n.y:-1e6,i=e.c-e.b*o,u=r?r.y:1e6,s=e.c-e.b*u):(i=n?n.x:-1e6,o=e.c-e.a*i,s=r?r.x:1e6,u=e.c-e.a*s);var a=[i,o],f=[s,u];t[e.region.l.index].push(a,f),t[e.region.r.index].push(a,f)}),t.map(function(t,n){var r=e[n][0],i=e[n][1];return t.forEach(function(e){e.angle=Math.atan2(e[0]-r,e[1]-i)}),t.sort(function(e,t){return e.angle-t.angle}).filter(function(e,n){return!n||e.angle-t[n-1].angle>1e-10})})};var l={l:"r",r:"l"};d3.geom.delaunay=function(e){var t=e.map(function(){return[]}),n=[];return i(e,function(n){t[n.region.l.index].push(e[n.region.r.index])}),t.forEach(function(t,r){var i=e[r],s=i[0],o=i[1];t.forEach(function(e){e.angle=Math.atan2(e[0]-s,e[1]-o)}),t.sort(function(e,t){return e.angle-t.angle});for(var u=0,a=t.length-1;u<a;u++)n.push([i,t[u],t[u+1]])}),n},d3.geom.quadtree=function(e,t,n,r,i){function a(e,t,n,r,i,s){if(isNaN(t.x)||isNaN(t.y))return;if(e.leaf){var o=e.point;o?Math.abs(o.x-t.x)+Math.abs(o.y-t.y)<.01?f(e,t,n,r,i,s):(e.point=null,f(e,o,n,r,i,s),f(e,t,n,r,i,s)):e.point=t}else f(e,t,n,r,i,s)}function f(e,t,n,r,i,o){var u=(n+i)*.5,f=(r+o)*.5,l=t.x>=u,c=t.y>=f,h=(c<<1)+l;e.leaf=!1,e=e.nodes[h]||(e.nodes[h]=s()),l?n=u:i=u,c?r=f:o=f,a(e,t,n,r,i,o)}var l,c=-1,h=e.length;h&&isNaN(e[0].x)&&(e=e.map(u));if(arguments.length<5)if(arguments.length===3)i=r=n,n=t;else{t=n=Infinity,r=i=-Infinity;while(++c<h)l=e[c],l.x<t&&(t=l.x),l.y<n&&(n=l.y),l.x>r&&(r=l.x),l.y>i&&(i=l.y);var p=r-t,d=i-n;p>d?i=n+p:r=t+d}var v=s();return v.add=function(e){a(v,e,t,n,r,i)},v.visit=function(e){o(e,v,t,n,r,i)},e.forEach(v.add),v}})();