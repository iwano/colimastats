(function(){function n(e){var t=0,n=0;for(;;){if(e(t,n))return[t,n];t===0?(t=n+1,n=0):(t-=1,n+=1)}}function r(e,t,n,r){var i,s,o,u,a,f,l;return i=r[e],s=i[0],o=i[1],i=r[t],u=i[0],a=i[1],i=r[n],f=i[0],l=i[1],(l-o)*(u-s)-(a-o)*(f-s)>0}function i(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function s(e,t,n,r){var i=e[0],s=t[0],o=n[0],u=r[0],a=e[1],f=t[1],l=n[1],c=r[1],h=i-o,p=s-i,d=u-o,v=a-l,m=f-a,g=c-l,y=(d*v-g*h)/(g*p-d*m);return[i+y*p,a+y*m]}function u(e,t){var n={list:e.map(function(e,t){return{index:t,x:e[0],y:e[1]}}).sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}),bottomSite:null},r={list:[],leftEnd:null,rightEnd:null,init:function(){r.leftEnd=r.createHalfEdge(null,"l"),r.rightEnd=r.createHalfEdge(null,"l"),r.leftEnd.r=r.rightEnd,r.rightEnd.l=r.leftEnd,r.list.unshift(r.leftEnd,r.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound:function(e){var t=r.leftEnd;do t=t.r;while(t!=r.rightEnd&&i.rightOf(t,e));return t=t.l,t},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[o[e.side]]}},i={bisect:function(e,t){var n={region:{l:e,r:t},ep:{l:null,r:null}},r=t.x-e.x,i=t.y-e.y,s=r>0?r:-r,o=i>0?i:-i;return n.c=e.x*r+e.y*i+(r*r+i*i)*.5,s>o?(n.a=1,n.b=i/r,n.c/=r):(n.b=1,n.a=r/i,n.c/=i),n},intersect:function(e,t){var n=e.edge,r=t.edge;if(!n||!r||n.region.r==r.region.r)return null;var i=n.a*r.b-n.b*r.a;if(Math.abs(i)<1e-10)return null;var s=(n.c*r.b-r.c*n.b)/i,o=(r.c*n.a-n.c*r.a)/i,u=n.region.r,a=r.region.r,f,l;u.y<a.y||u.y==a.y&&u.x<a.x?(f=e,l=n):(f=t,l=r);var c=s>=l.region.r.x;return c&&f.side==="l"||!c&&f.side==="r"?null:{x:s,y:o}},rightOf:function(e,t){var n=e.edge,r=n.region.r,i=t.x>r.x;if(i&&e.side==="l")return 1;if(!i&&e.side==="r")return 0;if(n.a===1){var s=t.y-r.y,o=t.x-r.x,u=0,a=0;!i&&n.b<0||i&&n.b>=0?a=u=s>=n.b*o:(a=t.x+t.y*n.b>n.c,n.b<0&&(a=!a),a||(u=1));if(!u){var f=r.x-n.region.l.x;a=n.b*(o*o-s*s)<f*s*(1+2*o/f+n.b*n.b),n.b<0&&(a=!a)}}else{var l=n.c-n.a*t.x,c=t.y-l,h=t.x-r.x,p=l-r.y;a=c*c>h*h+p*p}return e.side==="l"?a:!a},endPoint:function(e,n,r){e.ep[n]=r;if(!e.ep[o[n]])return;t(e)},distance:function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}},s={list:[],insert:function(e,t,n){e.vertex=t,e.ystar=t.y+n;for(var r=0,i=s.list,o=i.length;r<o;r++){var u=i[r];if(e.ystar>u.ystar||e.ystar==u.ystar&&t.x>u.vertex.x)continue;break}i.splice(r,0,e)},del:function(e){for(var t=0,n=s.list,r=n.length;t<r&&n[t]!=e;++t);n.splice(t,1)},empty:function(){return s.list.length===0},nextEvent:function(e){for(var t=0,n=s.list,r=n.length;t<r;++t)if(n[t]==e)return n[t+1];return null},min:function(){var e=s.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return s.list.shift()}};r.init(),n.bottomSite=n.list.shift();var u=n.list.shift(),a,f,l,c,h,p,d,v,m,g,y,b,w;for(;;){s.empty()||(a=s.min());if(u&&(s.empty()||u.y<a.y||u.y==a.y&&u.x<a.x))f=r.leftBound(u),l=r.right(f),d=r.rightRegion(f),b=i.bisect(d,u),p=r.createHalfEdge(b,"l"),r.insert(f,p),g=i.intersect(f,p),g&&(s.del(f),s.insert(f,g,i.distance(g,u))),f=p,p=r.createHalfEdge(b,"r"),r.insert(f,p),g=i.intersect(p,l),g&&s.insert(p,g,i.distance(g,u)),u=n.list.shift();else{if(!!s.empty())break;f=s.extractMin(),c=r.left(f),l=r.right(f),h=r.right(l),d=r.leftRegion(f),v=r.rightRegion(l),y=f.vertex,i.endPoint(f.edge,f.side,y),i.endPoint(l.edge,l.side,y),r.del(f),s.del(l),r.del(l),w="l",d.y>v.y&&(m=d,d=v,v=m,w="r"),b=i.bisect(d,v),p=r.createHalfEdge(b,w),r.insert(c,p),i.endPoint(b,o[w],y),g=i.intersect(c,p),g&&(s.del(c),s.insert(c,g,i.distance(g,d))),g=i.intersect(p,h),g&&s.insert(p,g,i.distance(g,d))}}for(f=r.right(r.leftEnd);f!=r.rightEnd;f=r.right(f))t(f.edge)}function a(){return{leaf:!0,nodes:[],point:null}}function f(e,t,n,r,i,s){if(!e(t,n,r,i,s)){var o=(n+i)*.5,u=(r+s)*.5,a=t.nodes;a[0]&&f(e,a[0],n,r,o,u),a[1]&&f(e,a[1],o,r,i,u),a[2]&&f(e,a[2],n,u,o,s),a[3]&&f(e,a[3],o,u,i,s)}}function l(e){return{x:e[0],y:e[1]}}d3.geom={},d3.geom.contour=function(r,i){var s=i||n(r),o=[],u=s[0],a=s[1],f=0,l=0,c=NaN,h=NaN,p=0;do p=0,r(u-1,a-1)&&(p+=1),r(u,a-1)&&(p+=2),r(u-1,a)&&(p+=4),r(u,a)&&(p+=8),p===6?(f=h===-1?-1:1,l=0):p===9?(f=0,l=c===1?-1:1):(f=e[p],l=t[p]),f!=c&&l!=h&&(o.push([u,a]),c=f,h=l),u+=f,a+=l;while(s[0]!=u||s[1]!=a);return o};var e=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],t=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(e){if(e.length<3)return[];var t=e.length,n=t-1,i=[],s=[],o,u,a=0,f,l,c,h,p,d,v,m;for(o=1;o<t;++o)e[o][1]<e[a][1]?a=o:e[o][1]==e[a][1]&&(a=e[o][0]<e[a][0]?o:a);for(o=0;o<t;++o){if(o===a)continue;l=e[o][1]-e[a][1],f=e[o][0]-e[a][0],i.push({angle:Math.atan2(l,f),index:o})}i.sort(function(e,t){return e.angle-t.angle}),v=i[0].angle,d=i[0].index,p=0;for(o=1;o<n;++o)u=i[o].index,v==i[o].angle?(f=e[d][0]-e[a][0],l=e[d][1]-e[a][1],c=e[u][0]-e[a][0],h=e[u][1]-e[a][1],f*f+l*l>=c*c+h*h?i[o].index=-1:(i[p].index=-1,v=i[o].angle,p=o,d=u)):(v=i[o].angle,p=o,d=u);s.push(a);for(o=0,u=0;o<2;++u)i[u].index!==-1&&(s.push(i[u].index),o++);m=s.length;for(;u<n;++u){if(i[u].index===-1)continue;while(!r(s[m-2],s[m-1],i[u].index,e))--m;s[m++]=i[u].index}var g=[];for(o=0;o<m;++o)g.push(e[s[o]]);return g},d3.geom.polygon=function(e){return e.area=function(){var t=0,n=e.length,r=e[n-1][0]*e[0][1],i=e[n-1][1]*e[0][0];while(++t<n)r+=e[t-1][0]*e[t][1],i+=e[t-1][1]*e[t][0];return(i-r)*.5},e.centroid=function(t){var n=-1,r=e.length-1,i=0,s=0,o,u,a;arguments.length||(t=-1/(6*e.area()));while(++n<r)o=e[n],u=e[n+1],a=o[0]*u[1]-u[0]*o[1],i+=(o[0]+u[0])*a,s+=(o[1]+u[1])*a;return[i*t,s*t]},e.clip=function(t){var n,r=-1,o=e.length,u,a,f=e[o-1],l,c,h;while(++r<o){n=t.slice(),t.length=0,l=e[r],c=n[(a=n.length)-1],u=-1;while(++u<a)h=n[u],i(h,f,l)?(i(c,f,l)||t.push(s(c,h,f,l)),t.push(h)):i(c,f,l)&&t.push(s(c,h,f,l)),c=h;f=l}return t},e},d3.geom.voronoi=function(e){var t=e.map(function(){return[]});return u(e,function(e){var n,r,i,s,o,u;e.a===1&&e.b>=0?(n=e.ep.r,r=e.ep.l):(n=e.ep.l,r=e.ep.r),e.a===1?(o=n?n.y:-1e6,i=e.c-e.b*o,u=r?r.y:1e6,s=e.c-e.b*u):(i=n?n.x:-1e6,o=e.c-e.a*i,s=r?r.x:1e6,u=e.c-e.a*s);var a=[i,o],f=[s,u];t[e.region.l.index].push(a,f),t[e.region.r.index].push(a,f)}),t.map(function(t,n){var r=e[n][0],i=e[n][1];return t.forEach(function(e){e.angle=Math.atan2(e[0]-r,e[1]-i)}),t.sort(function(e,t){return e.angle-t.angle}).filter(function(e,n){return!n||e.angle-t[n-1].angle>1e-10})})};var o={l:"r",r:"l"};d3.geom.delaunay=function(e){var t=e.map(function(){return[]}),n=[];return u(e,function(n){t[n.region.l.index].push(e[n.region.r.index])}),t.forEach(function(t,r){var i=e[r],s=i[0],o=i[1];t.forEach(function(e){e.angle=Math.atan2(e[0]-s,e[1]-o)}),t.sort(function(e,t){return e.angle-t.angle});for(var u=0,a=t.length-1;u<a;u++)n.push([i,t[u],t[u+1]])}),n},d3.geom.quadtree=function(e,t,n,r,i){function p(e,t,n,r,i,s){if(isNaN(t.x)||isNaN(t.y))return;if(e.leaf){var o=e.point;o?Math.abs(o.x-t.x)+Math.abs(o.y-t.y)<.01?d(e,t,n,r,i,s):(e.point=null,d(e,o,n,r,i,s),d(e,t,n,r,i,s)):e.point=t}else d(e,t,n,r,i,s)}function d(e,t,n,r,i,s){var o=(n+i)*.5,u=(r+s)*.5,f=t.x>=o,l=t.y>=u,c=(l<<1)+f;e.leaf=!1,e=e.nodes[c]||(e.nodes[c]=a()),f?n=o:i=o,l?r=u:s=u,p(e,t,n,r,i,s)}var s,o=-1,u=e.length;u&&isNaN(e[0].x)&&(e=e.map(l));if(arguments.length<5)if(arguments.length===3)i=r=n,n=t;else{t=n=Infinity,r=i=-Infinity;while(++o<u)s=e[o],s.x<t&&(t=s.x),s.y<n&&(n=s.y),s.x>r&&(r=s.x),s.y>i&&(i=s.y);var c=r-t,h=i-n;c>h?i=n+c:r=t+h}var v=a();return v.add=function(e){p(v,e,t,n,r,i)},v.visit=function(e){f(e,v,t,n,r,i)},e.forEach(v.add),v}})();